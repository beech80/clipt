/* Enhanced Animations for the Xbox-style joystick */
@keyframes pulse-arrow {
  0% { opacity: 0.3; transform: scaleY(1); filter: brightness(100%); }
  50% { opacity: 0.9; transform: scaleY(1.3); filter: brightness(130%); }
  100% { opacity: 0.3; transform: scaleY(1); filter: brightness(100%); }
}

@keyframes glow-up {
  0% { box-shadow: 0 -3px 8px rgba(135, 106, 245, 0.4); }
  50% { box-shadow: 0 -8px 18px rgba(135, 106, 245, 0.8); }
  100% { box-shadow: 0 -3px 8px rgba(135, 106, 245, 0.4); }
}

@keyframes glow-down {
  0% { box-shadow: 0 3px 8px rgba(135, 106, 245, 0.4); }
  50% { box-shadow: 0 8px 18px rgba(135, 106, 245, 0.8); }
  100% { box-shadow: 0 3px 8px rgba(135, 106, 245, 0.4); }
}

/* Xbox-style spring physics animation with improved elastic feel */
@keyframes xbox-spring-return {
  0% { transform: translate(var(--last-x, 0), var(--last-y, 0)); box-shadow: 0 0 15px rgba(135, 106, 245, 0.5); }
  15% { transform: translate(calc(var(--last-x, 0) * 0.6), calc(var(--last-y, 0) * 0.6)); box-shadow: 0 0 12px rgba(135, 106, 245, 0.4); }
  35% { transform: translate(calc(var(--last-x, 0) * 0.2), calc(var(--last-y, 0) * 0.2)); box-shadow: 0 0 10px rgba(135, 106, 245, 0.3); }
  55% { transform: translate(calc(var(--last-x, 0) * -0.1), calc(var(--last-y, 0) * -0.1)); box-shadow: 0 0 8px rgba(135, 106, 245, 0.2); }
  75% { transform: translate(calc(var(--last-x, 0) * -0.05), calc(var(--last-y, 0) * -0.05)); box-shadow: 0 0 7px rgba(135, 106, 245, 0.2); }
  90% { transform: translate(calc(var(--last-x, 0) * 0.02), calc(var(--last-y, 0) * 0.02)); box-shadow: 0 0 5px rgba(135, 106, 245, 0.1); }
  100% { transform: translate(0, 0); box-shadow: 0 0 5px rgba(135, 106, 245, 0.1); }
}

/* Enhanced joystick movement with physical resistance and improved performance */
.joystick-handle {
  transition: transform 0.05s cubic-bezier(0.17, 0.67, 0.83, 0.67), 
              box-shadow 0.12s ease, 
              filter 0.1s ease;
  will-change: transform, box-shadow, filter;
  /* Improved 3D feel with subtle shadow during movement */
  filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.5));
  /* Add a subtle glow effect when moving */
  box-shadow: 0 0 5px rgba(135, 106, 245, 0.3);
}

/* Enhance touch visibility - scale up slightly when active */
.joystick-handle:active {
  transform: scale(1.1);
  box-shadow: 0 0 15px rgba(135, 106, 245, 0.9);
  filter: brightness(1.2);
}

.joystick-spring-return {
  animation: xbox-spring-return 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
  /* Disable transition during spring animation */
  transition: none !important;
}

/* Active indicator styles with variable intensity */
.joystick-up-indicator.active {
  background: rgba(135, 106, 245, calc(0.5 + var(--intensity, 50) / 200)) !important;
  height: calc(8px + (var(--intensity, 50) / 10)) !important;
  animation: pulse-arrow 1.2s infinite ease-in-out !important;
  filter: brightness(calc(100% + var(--intensity, 0) / 2)) !important;
  transition: all 0.05s ease-out !important;
  box-shadow: 0 -2px 8px rgba(135, 106, 245, 0.7) !important;
}

.joystick-down-indicator.active {
  background: rgba(135, 106, 245, calc(0.5 + var(--intensity, 50) / 200)) !important;
  transition: all 0.05s ease-out !important;
  height: calc(8px + (var(--intensity, 50) / 10)) !important;
  animation: pulse-arrow 1.2s infinite ease-in-out !important;
  filter: brightness(calc(100% + var(--intensity, 0) / 2)) !important;
  box-shadow: 0 2px 8px rgba(135, 106, 245, 0.7) !important;
}

.joystick-handle-up {
  animation: glow-up 1.2s infinite ease-in-out !important;
  border-bottom: 2px solid rgba(135, 106, 245, calc(0.5 + var(--move-intensity, 50) / 200)) !important;
  box-shadow: 0 -3px calc(5px + var(--move-intensity, 0) / 10 * 1px) rgba(135, 106, 245, calc(0.4 + var(--move-intensity, 0) / 200)) !important;
}

.joystick-handle-down {
  animation: glow-down 1.2s infinite ease-in-out !important;
  border-top: 2px solid rgba(135, 106, 245, calc(0.5 + var(--move-intensity, 50) / 200)) !important;
  box-shadow: 0 3px calc(5px + var(--move-intensity, 0) / 10 * 1px) rgba(135, 106, 245, calc(0.4 + var(--move-intensity, 0) / 200)) !important;
}

/* Intensity classes for better visual feedback */
.low-intensity {
  filter: brightness(110%) !important;
  transition: filter 0.15s ease !important;
}

.medium-intensity {
  filter: brightness(125%) !important;
  transition: filter 0.12s ease !important;
}

.high-intensity {
  filter: brightness(140%) !important;
  text-shadow: 0 0 5px rgba(255, 255, 255, 0.5) !important;
  transition: filter 0.08s ease, text-shadow 0.08s ease !important;
}
